<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <ProjectGuid>{B1A02ADB-14C2-4451-93C4-1A7E33D3EB2D}</ProjectGuid>
    <RootNamespace>H.NET.SearchDeskBand</RootNamespace>
    <AssemblyName>H.NET.SearchDeskBand</AssemblyName>
    <TargetFramework>net472</TargetFramework>
    <AssemblyTitle>SearchDeskBand</AssemblyTitle>
    <Product>SearchDeskBand</Product>
    <Copyright>Copyright ©  2018</Copyright>
    <OutputPath>bin\$(Configuration)\</OutputPath>
    <RegisterForComInterop>false</RegisterForComInterop>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugType>full</DebugType>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
  </PropertyGroup>
  <PropertyGroup>
    <SignAssembly>true</SignAssembly>
  </PropertyGroup>
  <PropertyGroup>
    <AssemblyOriginatorKeyFile>key.snk</AssemblyOriginatorKeyFile>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System.Windows.Forms" />
  </ItemGroup>
  <ItemGroup>
    <Compile Update="DeskBandControl.cs">
      <SubType>UserControl</SubType>
    </Compile>
    <Compile Update="DeskBandControl.Designer.cs">
      <DependentUpon>DeskBandControl.cs</DependentUpon>
    </Compile>
    <Compile Update="DeskBandWindow.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Update="DeskBandWindow.Designer.cs">
      <DependentUpon>DeskBandWindow.cs</DependentUpon>
    </Compile>
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Update="DeskBandControl.resx">
      <DependentUpon>DeskBandControl.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Update="DeskBandWindow.resx">
      <DependentUpon>DeskBandWindow.cs</DependentUpon>
    </EmbeddedResource>
  </ItemGroup>
  <ItemGroup>
    <None Include="key.snk" />
    <None Include="unregister.cmd" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\..\H.NET.Core\H.NET.Core.csproj" />
    <ProjectReference Include="..\..\Utilities\CommandsStorage\CommandsStorage.csproj" />
    <ProjectReference Include="..\..\Utilities\IPC\IPC.csproj" />
    <ProjectReference Include="..\..\Utilities\Startup\Startup.csproj" />
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="SharpShell" Version="2.6.0" />
  </ItemGroup>
  <Target Name="PreBuild" BeforeTargets="PreBuildEvent">
    <Exec Command="IF EXIST $(TargetDir)SharpShell.dll (&#xD;&#xA;  %25SystemRoot%25\Microsoft.NET\Framework64\v4.0.30319\regasm.exe  $(TargetDir)SharpShell.dll /tlb /codebase /unregister /nologo /silent&#xD;&#xA;)&#xD;&#xA;IF EXIST $(TargetPath) (&#xD;&#xA;  %25SystemRoot%25\Microsoft.NET\Framework64\v4.0.30319\regasm.exe  $(TargetPath) /tlb /codebase /unregister /nologo /silent&#xD;&#xA; )" />
  </Target>
  <Target Name="PostBuild" AfterTargets="PostBuildEvent">
    <Exec Command="%25SystemRoot%25\Microsoft.NET\Framework64\v4.0.30319\regasm.exe  $(TargetDir)SharpShell.dll /tlb /codebase /nologo&#xD;&#xA;%25SystemRoot%25\Microsoft.NET\Framework64\v4.0.30319\regasm.exe  $(TargetPath) /tlb /codebase /nologo" />
  </Target>
</Project>